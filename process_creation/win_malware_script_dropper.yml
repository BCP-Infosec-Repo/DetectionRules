title: WScript or CScript Dropper
status: experimental
description: Detects wscript/cscript executions of scripts located in user directories
author: Margaritis Dimitrios (idea), Florian Roth (rule)
tags:
    - attack.defense_evasion
    - attack.execution
    - attack.t1064
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        path:
            - '*\wscript.exe'
            - '*\cscript.exe'
        cmdline:
            - '* C:\owner_uids\\*.jse *'
            - '* C:\owner_uids\\*.vbe *'
            - '* C:\owner_uids\\*.js *'
            - '* C:\owner_uids\\*.vba *'
            - '* C:\owner_uids\\*.vbs *'
            - '* C:\ProgramData\\*.jse *'
            - '* C:\ProgramData\\*.vbe *'
            - '* C:\ProgramData\\*.js *'
            - '* C:\ProgramData\\*.vba *'
            - '* C:\ProgramData\\*.vbs *'
    falsepositive:
        parent_path: '*\winzip*'
    condition: selection and not falsepositive
fields:
    - cmdline
    - Parentcmdline
falsepositives:
    - Winzip
    - Other self-extractors
level: high
